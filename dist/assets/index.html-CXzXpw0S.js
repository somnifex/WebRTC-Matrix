import{d as x,r as i,o as D,g as f,c as u,a as r,b as e,t as g,m as b,_ as S,l as B}from"./_plugin-vue_export-helper-KKkw3Lli.js";import{S as c,b as d}from"./storage-BF9_fGL3.js";import{m as L}from"./match-C4wd3_Kx.js";const A={class:"popup-container"},I={key:0,class:"main-content"},O={class:"domain-info"},U={key:1},W={key:2},E=x({__name:"App",setup(P){const a=i(""),o=i(!1),l=i(!0),p=i(null),k=async()=>{const s=await d.tabs.query({active:!0,currentWindow:!0});if(s.length>0&&s[0].url){const t=new URL(s[0].url);if(t.protocol.startsWith("http"))return t.hostname}return null},w=async()=>{l.value=!0;const s=await k();if(!s){a.value="Unknown / Restricted",l.value=!1;return}a.value=s,p.value=await c.getSettings();const t=await c.getRules(),n=L(s,t);n?o.value=n==="block":o.value=p.value.defaultRule==="block",l.value=!1},y=async()=>{if(!a.value||a.value.includes(" "))return;const s=!o.value;o.value=s;const t=await c.getRules(),n=t.findIndex(R=>R.domain===a.value),m=s?"block":"allow";n>=0?(t[n].action=m,t[n].timestamp=Date.now()):t.push({id:crypto.randomUUID(),domain:a.value,action:m,timestamp:Date.now()}),await c.setRules(t)},_=()=>{d.runtime.openOptionsPage()},C=()=>{d.tabs.reload()};D(()=>{w()});const v=f(()=>o.value?"#ff4d4f":"#52c41a"),h=f(()=>o.value?"BLOCKED":"ALLOWED");return(s,t)=>(r(),u("div",A,[t[4]||(t[4]=e("div",{class:"header"},[e("h2",null,"WebRTC Matrix")],-1)),!l.value&&a.value&&!a.value.includes(" ")?(r(),u("div",I,[e("div",O,g(a.value),1),e("div",{class:"toggle-section",onClick:y},[e("div",{class:"power-btn",style:b({backgroundColor:v.value})},[...t[0]||(t[0]=[e("span",{class:"icon"},"‚èª",-1)])],4),e("div",{class:"status-label",style:b({color:v.value})},g(h.value),5)]),t[1]||(t[1]=e("p",{class:"hint"},"Click button to toggle rule for this domain",-1))])):l.value?(r(),u("div",W,[...t[3]||(t[3]=[e("p",null,"Loading...",-1)])])):(r(),u("div",U,[...t[2]||(t[2]=[e("p",null,"System page or invalid context.",-1)])])),e("div",{class:"footer"},[e("button",{onClick:_},"Dashboard"),e("button",{onClick:C,class:"secondary"},"Refresh Page")])]))}}),M=S(E,[["__scopeId","data-v-8735c10f"]]);B(M).mount("#app");
